\RequirePackage{mathtools}
\RequirePackage{xifthen}

%%%%%%%%%%%
%% To do &&
%%%%%%%%%%%

% Braket automatically add cdots if no arguments are specified. (See mathtools documentation.)


%%%%%%%%%%%%%%%%%%%%
%% General macros %%
%%%%%%%%%%%%%%%%%%%%

\newcommand{\conj}[1]{#1^{*}}					% Complex conjugation


%%%%%%%%%%%%%%%%%%%%
%% Linear algebra %%
%%%%%%%%%%%%%%%%%%%%

\newcommand{\adj}[1]{#1^{\dagger}}				% Adjoint of operator


%%%%%%%%%%%%%%%%%%%%%%%
%% Quantum mechanics %%
%%%%%%%%%%%%%%%%%%%%%%%

% Define bra and ket. Use starred versions for automatic resizing.
\newcommand{\bra}[1]{\mathinner {\langle {#1}\rvert}}
\WithSuffix\newcommand\bra*[1]{\mathinner {\left\langle {#1}\right|}}

\newcommand{\ket}[1]{\mathinner {\lvert {#1}\rangle}}
\WithSuffix\newcommand\ket*[1]{\mathinner {\left| {#1}\right\rangle}}

% Define combined bra-ket. Takes two arguments.
\DeclarePairedDelimiterX{\braket}[2]{\langle}{\rangle}{#1\,\delimsize\vert\,\mathopen{}#2}

% Matrix elements; takes three arguments.
\DeclarePairedDelimiterX{\matrixel}[3]{\langle}{\rangle}%
{#1\,\delimsize\vert\,\mathopen{}#2\,\delimsize\vert\,\mathopen{}#3}

% Commutator. Takes two arguments.
\DeclarePairedDelimiterX{\comm}[2]{[}{]}{#1, #2}

% Expectation value. If no optional argument is specified, it returns the ordinary expectation value '<Q>', but if the state 'x' is specified as an optional argument, it instead returns the matrix element '<x|Q|x>'.
\DeclarePairedDelimiter{\expectationvalue}{\langle}{\rangle}
\newcommand{\expval}[2][]{%
	\ifthenelse{\isempty{#1}}%
	{\expectationvalue{#2}}% if no optional argument
	{\matrixel{#1}{#2}{#1}}% if optional argument
}
